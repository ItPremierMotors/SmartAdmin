@model SmartAdmin.Models.Catalogo.Tecnico.EditTecnicoViewModel

<form id="formEditarTecnico">
    <input type="hidden" asp-for="TecnicoId" />

    <div class="row">
        <div class="col-md-4 mb-3">
            <label asp-for="Codigo" class="form-label">
                @Html.DisplayNameFor(m => m.Codigo)<span class="text-danger">*</span>
            </label>
            <input asp-for="Codigo" class="form-control text-uppercase" required />
            <span asp-validation-for="Codigo" class="text-danger"></span>
        </div>
        <div class="col-md-4 mb-3">
            <label asp-for="Nombre" class="form-label">
                @Html.DisplayNameFor(m => m.Nombre)<span class="text-danger">*</span>
            </label>
            <input asp-for="Nombre" class="form-control" required />
            <span asp-validation-for="Nombre" class="text-danger"></span>
        </div>
        <div class="col-md-4 mb-3">
            <label asp-for="Apellidos" class="form-label">
                @Html.DisplayNameFor(m => m.Apellidos)<span class="text-danger">*</span>
            </label>
            <input asp-for="Apellidos" class="form-control" required />
            <span asp-validation-for="Apellidos" class="text-danger"></span>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6 mb-3">
            <label asp-for="Especialidad" class="form-label">
                @Html.DisplayNameFor(m => m.Especialidad)
            </label>
            <input asp-for="Especialidad" class="form-control" />
            <span asp-validation-for="Especialidad" class="text-danger"></span>
        </div>
        <div class="col-md-3 mb-3">
            <label asp-for="BahiaAsignada" class="form-label">
                @Html.DisplayNameFor(m => m.BahiaAsignada)
            </label>
            <input asp-for="BahiaAsignada" class="form-control" type="number" min="1" max="100" />
            <span asp-validation-for="BahiaAsignada" class="text-danger"></span>
        </div>
        <div class="col-md-3 mb-3">
            <label asp-for="SucursalId" class="form-label">
                @Html.DisplayNameFor(m => m.SucursalId)
            </label>
            <select asp-for="SucursalId" class="form-select" id="SucursalIdEdit">
                <option value="">Seleccione sucursal...</option>
            </select>
            <span asp-validation-for="SucursalId" class="text-danger"></span>
        </div>
    </div>
</form>

<div class="d-flex justify-content-end gap-2 mt-4 pt-3 border-top">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
        <i class="fas fa-times me-1"></i> Cancelar
    </button>
    <button type="button" class="btn btn-primary" id="btnActualizarTecnico" onclick="actualizarTecnico()">
        <i class="fas fa-save me-1"></i> Actualizar
    </button>
</div>

<script>
    $(document).ready(function () {
        $.ajax({
            url: '@Url.Action("GetSucursales", "Tecnicos")',
            type: 'GET',
            success: function (response) {
                if (response.success && response.data) {
                    const select = $('#SucursalIdEdit');
                    const currentValue = @(Model.SucursalId.HasValue ? Model.SucursalId.Value.ToString() : "null");
                    response.data.forEach(s => {
                        const selected = s.id == currentValue ? 'selected' : '';
                        select.append(`<option value="${s.id}" ${selected}>${s.nombre}</option>`);
                    });
                }
            }
        });
    });
</script>
